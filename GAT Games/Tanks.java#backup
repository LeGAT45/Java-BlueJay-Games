/*
 * WASD to move left tank
 * Arrow keys to move right tank
 * use mouse to aim right tank
 * use N and M to rotate cannon of the tank left and right
 * 
 * if you wanna play different maps you'll have to choose it within the code currently by modifying map = _;
 * to the map you want  -  currenly only map 0, map 1, map 2
 * 
 * you can also turn powerups off or on if you want to by modifying power = false; or power = true;
 */
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import java.util.*;
import java.applet.*;
public class Tanks extends JApplet{
    @Override
    public void init(){
        add(new Tanks_Engine());
    }
}
class Tanks_Engine extends JPanel implements MouseMotionListener, MouseListener, KeyListener{
    // keyListener
    int ch;
    // mouseListener
    int mX;
    int mY;
    // ^^^^^^^^^^^^^
    ArrayList<Tank> tanks;
    ArrayList<Object> obj;
    boolean not;
    boolean won;
    int alive;
    boolean tie;
    boolean pause;
    int map;
    boolean power;
    Powerup p;
    Random rand;
    int pTimer;
    int gamemode;
    int tempx;
    int tempy;
    int time;
    int stock;
    public Tanks_Engine(){
        // JApplet
        this.setFocusable(true);
        this.requestFocusInWindow();
        // keyListener
        addKeyListener(this);
        ch = 0;
        // mouseMotionListener
        addMouseMotionListener(this);
        // mouseListener
        addMouseListener(this);
        mX = 0;
        mY = 0;
        rand = new Random();
        // ^^^^^^^^^^^
        tanks = new ArrayList<Tank>();
        obj = new ArrayList<Object>();
        
        
        
        map = 1;
        gamemode = 1;
        time = 3000000;
        stock = 3;
        
        
        
        power = true;
        tempx = 125;
        tempy = 87;
        tanks.add(0,new Tank(1485,400,180,1,1,false,false,false,false,false,false,false,0,0,false,0,5,0,stock,0));
        tanks.add(1,new Tank(100,400,0,1,1,false,false,false,false,false,false,false,0,0,false,0,5,0,stock,0));
        // Painful Paintball
        if(map == 0){
            obj.add(0,new Object(200,200,300,600));
            obj.add(0,new Object(1300,200,1400,600));
            obj.add(0,new Object(600,350,1000,450));
            obj.add(0,new Object(400,100,500,200));
            obj.add(0,new Object(400,600,500,700));
            obj.add(0,new Object(1100,100,1200,200));
            obj.add(0,new Object(1100,600,1200,700));
            obj.add(0,new Object(750,0,850,200));
            obj.add(0,new Object(750,600,850,800));
            if(power){
                p = new Powerup(800,500,rand.nextInt(4)+1);
            }
        }
        // Cagy Crosshair
        else if(map == 1){
            obj.add(0,new Object(575,250,750,325));
            obj.add(0,new Object(575,475,750,550));
            obj.add(0,new Object(850,250,1025,325));
            obj.add(0,new Object(850,475,1025,550));
            obj.add(0,new Object(575,325,650,475));
            obj.add(0,new Object(950,325,1025,475));
            //top left
            obj.add(0,new Object(75,200,275,275));
            obj.add(0,new Object(200,75,275,200));
            // bottom left
            obj.add(0,new Object(75,525,200,600));
            obj.add(0,new Object(200,525,275,725));
            //top right
            obj.add(0,new Object(1305,200,1505,275));
            obj.add(0,new Object(1305,75,1380,200));
            // bottom right
            obj.add(0,new Object(1305,525,1505,600));
            obj.add(0,new Object(1305,600,1380,725));
            //top
            obj.add(0,new Object(400,100,1180,150));
            //bottom
            obj.add(0,new Object(400,650,1180,700));
            //left
            obj.add(0,new Object(150,350,200,450));
            // right
            obj.add(0,new Object(1380,350,1430,450));
            if(power){
                p = new Powerup(800,400,rand.nextInt(4)+1);
            }
        }
        // Confusing Checkers? Maybe
        else if(map == 2){
            for(int count = 0;count != 32;count++){
                if(tempx >= 1500){
                    tempx = 125;
                    tempy += 175;
                }
                obj.add(0,new Object(tempx,tempy,tempx+100,tempy+100));
                tempx+=175;
            }
            if(power){
                p = new Powerup(790,400,rand.nextInt(4)+1);
            }
        }
        // Mesmerizing Maze
        else if(map == 3){
            obj.add(0,new Object(100,100,100,100));
        }
        not = false;
        won = false;
        alive = 4;
        tie = false;
        pause = false;
        pTimer = 0;
    }
    // keyListener class methods
    public void keyTyped(KeyEvent k){
    }
    public void keyReleased(KeyEvent k){
        ch = k.getKeyCode();
        if(ch == KeyEvent.VK_UP){
            tanks.get(0).up = !true;
        }
        if(ch == KeyEvent.VK_DOWN){
            tanks.get(0).down = !true;
        }
        if(ch == KeyEvent.VK_LEFT){
            tanks.get(0).left = !true;
        }
        if(ch == KeyEvent.VK_RIGHT){
            tanks.get(0).right = !true;
        }
        if(ch == KeyEvent.VK_W){
            tanks.get(1).up = !true;
        }
        if(ch == KeyEvent.VK_S){
            tanks.get(1).down = !true;
        }
        if(ch == KeyEvent.VK_A){
            tanks.get(1).left = !true;
        }
        if(ch == KeyEvent.VK_D){
            tanks.get(1).right = !true;
        }
        if(ch == KeyEvent.VK_N){
            tanks.get(1).n = false;
        }
        if(ch == KeyEvent.VK_M){
            tanks.get(1).m = false;
        }
        if(ch == KeyEvent.VK_SPACE){
            tanks.get(1).shoot = false;
        }
    }
    public void keyPressed(KeyEvent k){
        ch = k.getKeyCode();
        if(ch == KeyEvent.VK_P){
            pause = !pause;
        }
        if(!won && !tie && !pause){
            if(!tanks.get(0).dead){
                if(ch == KeyEvent.VK_UP){
                    tanks.get(0).up = true;
                }
                if(ch == KeyEvent.VK_DOWN){
                    tanks.get(0).down = true;
                }
                if(ch == KeyEvent.VK_LEFT){
                    tanks.get(0).left = true;
                }
                if(ch == KeyEvent.VK_RIGHT){
                    tanks.get(0).right = true;
                }
            }
            else{
                tanks.get(0).up = false;
                tanks.get(0).down = false;
                tanks.get(0).left = false;
                tanks.get(0).right = false;
            }
            if(!tanks.get(1).dead){
                if(ch == KeyEvent.VK_W){
                    tanks.get(1).up = true;
                }
                if(ch == KeyEvent.VK_S){
                    tanks.get(1).down = true;
                }
                if(ch == KeyEvent.VK_A){
                    tanks.get(1).left = true;
                }
                if(ch == KeyEvent.VK_D){
                    tanks.get(1).right = true;
                }
                if(ch == KeyEvent.VK_N){
                    tanks.get(1).n = true;
                }
                else if(ch == KeyEvent.VK_M){
                    tanks.get(1).m = true;
                }
                if(ch == KeyEvent.VK_SPACE){
                    if(tanks.get(1).state == 1){
                        tanks.get(1).shoot = true;
                    }
                    else if(tanks.get(1).delay == 0 && tanks.get(1).state == 2){
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).delay = 25;
                    }
                    else if(tanks.get(1).delay == 0 && tanks.get(1).state == 3){
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a+10,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a+5,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a-5,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a-10,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        tanks.get(1).delay = 25;
                    }
                    else if(tanks.get(1).state == 4 && tanks.get(1).delay == 0){
                        if(tanks.get(1).shots.size()==0){
                            tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        }
                        else if(tanks.get(1).shots.size()== 1){
                            for(int count = 0;count != 12;count++){
                                tanks.get(1).shots.add(1,new Bullet(tanks.get(1).shots.get(0).x,tanks.get(1).shots.get(0).y,count*30,1,1,0,0,0,0));
                            }
                            tanks.get(1).shots.remove(0);
                        }
                    }
                    else if(!tanks.get(1).shoot && tanks.get(1).state == 0){
                        if(tanks.get(1).shots.size() < 3){
                            tanks.get(1).shots.add(0,new Bullet(tanks.get(1).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(1).a))) * tanks.get(1).d,tanks.get(1).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(1).a))) * tanks.get(1).u,tanks.get(1).a,tanks.get(1).d,tanks.get(1).u,0,0,0,0));
                        }
                    }
                }
            }
            else{
                tanks.get(1).up = false;
                tanks.get(1).down = false;
                tanks.get(1).left = false;
                tanks.get(1).right = false;
                tanks.get(1).n = false;
                tanks.get(1).m = false;
            }
        }
        else{
            if(ch == KeyEvent.VK_R){
                tanks.clear();
                tanks.add(0,new Tank(1485,400,180,1,1,false,false,false,false,false,false,false,0,0,false,0,5,0,stock,0));
                tanks.add(1,new Tank(100,400,0,1,1,false,false,false,false,false,false,false,0,0,false,0,5,0,stock,0));
                not = false;
                won = false;
                alive = 2;
                tie = false;
                pTimer = 0;
                if(power){
                    p.state = rand.nextInt(4)+1;
                }
            }
        }
    }
    //mouseMotionListener
    public void mouseDragged(MouseEvent me){
        mX = me.getX();
        mY = me.getY();
    }
    public void mouseMoved(MouseEvent me){
        mX = me.getX();
        mY = me.getY();
    }
    // mouseListener class methods
    public void mouseEntered(MouseEvent me){
    }
    public void mouseExited(MouseEvent me){
    }
    public void mouseClicked(MouseEvent me){
    }
    public void mouseReleased(MouseEvent me){
        tanks.get(0).shoot = false;
    }
    public void mousePressed(MouseEvent me){
        if(!tanks.get(0).shoot){
            mX = me.getX();
            mY = me.getY();
        }
        if(!won && !tie && !pause){
            if(!tanks.get(0).dead){
                if(mX < tanks.get(0).x && tanks.get(0).d == 1){
                    tanks.get(0).d *= -1;
                }
                else if(mX > tanks.get(0).x && tanks.get(0).d == -1){
                    tanks.get(0).d *= -1;
                }
                if(mY > tanks.get(0).y && tanks.get(0).u == 1){
                    tanks.get(0).u *= -1;
                }
                else if(mY < tanks.get(0).y && tanks.get(0).u == -1){
                    tanks.get(0).u *= -1;
                }
                tanks.get(0).a = Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))));
                if(tanks.get(0).state == 1){
                    tanks.get(0).shoot = true;
                }
                else if(tanks.get(0).delay == 0 && tanks.get(0).state == 2){
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x)))),tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).delay = 25;
                }
                else if(tanks.get(0).delay == 0 && tanks.get(0).state == 3){
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))+10,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))+5,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x)))),tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))-5,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))-10,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    tanks.get(0).delay = 25;
                }
                else if(tanks.get(0).state == 4 && tanks.get(0).delay == 0){
                    if(tanks.get(0).shots.size()==0){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x)))),tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                    else if(tanks.get(0).shots.size()== 1){
                        for(int count = 0;count != 12;count++){
                            tanks.get(0).shots.add(1,new Bullet(tanks.get(0).shots.get(0).x,tanks.get(0).shots.get(0).y,count*30,1,1,0,0,0,0));
                        }
                        tanks.get(0).shots.remove(0);
                    }
                }
                else if(!tanks.get(0).shoot && tanks.get(0).state == 0){
                    if(tanks.get(0).shots.size() < 3){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x)))),tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                }
            }
        }
    }
    // ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    public void paintComponent(Graphics g){
        super.paintComponent(g);
        setBackground(new Color(200,180,100));
        Graphics2D g2 = (Graphics2D) g;
        g2.setStroke(new BasicStroke(15));
        g2.setColor(new Color(100,70,0));
        g2.drawRect(0,0,1580,800);
        alive = tanks.size();
        for(int count = 0;count != obj.size();count++){
            obj.get(count).drawObject(g);
        }
        if(pause){
            g.setColor(Color.green);
            g.fillRect(770,360,20,80);
            g.fillRect(810,360,20,80);
        }
        if(!won && !tie && !pause){
            if(!tanks.get(1).dead){
                if(tanks.get(1).n){
                    tanks.get(1).a += 5;
                }
                else if(tanks.get(1).m){
                    tanks.get(1).a -= 5;
                }
            }
        }
        if(power){
            if(p.state == 0){
                pTimer++;
            }
            if(pTimer == 1000){
                p.state = rand.nextInt(1)+1;
                pTimer = 0;
            }
        }
        if(gamemode == 1){
            g.setFont(new Font("Arial",Font.BOLD,25));
            g.setColor(Color.green);
            g.drawString(""+time/30,750,30);
            if(!won && !tie){
                time--;
            }
        }
        for(int count = 0;count != tanks.size();count++){
            if(!won && !tie && gamemode == 1){
                if(tanks.get(count).dead && tanks.get(count).respawn == 0){
                    tanks.get(count).respawn = 140;
                }
                else if(tanks.get(count).dead && tanks.get(count).respawn == 1){
                    tanks.get(count).respawn = 0;
                    tanks.get(count).dead = false;
                    tanks.get(count).y = 400;
                    if(count == 0){
                        if(tanks.get(1).x < 800){
                            tanks.get(0).x = 1485;
                        }
                        else{
                            tanks.get(0).x = 100;
                        }
                    }
                    else{
                        if(tanks.get(0).x < 800){
                            tanks.get(1).x = 1485;
                        }
                        else{
                            tanks.get(1).x = 100;
                        }
                    }
                }
            }
            else if(!won && !tie && gamemode == 0){
                if(tanks.get(count).dead && tanks.get(count).respawn == 0){
                    tanks.get(count).respawn = 140;
                }
                else if(tanks.get(count).dead && tanks.get(count).respawn == 1){
                    tanks.get(count).respawn = 0;
                    tanks.get(count).dead = false;
                    tanks.get(count).y = 400;
                    if(count == 0){
                        if(tanks.get(1).x < 800){
                            tanks.get(0).x = 1485;
                        }
                        else{
                            tanks.get(0).x = 100;
                        }
                    }
                    else{
                        if(tanks.get(0).x < 800){
                            tanks.get(1).x = 1485;
                        }
                        else{
                            tanks.get(1).x = 100;
                        }
                    }
                }
                if(tanks.get(0).stock == -1 && tanks.get(1).stock == -1){
                    tie = true;
                }
                else if(tanks.get(count).stock == -1){
                    won = true;
                }
            }
            if(tanks.get(count).dead && tanks.get(count).respawn > 0){
                tanks.get(count).respawn--;
            }
            if(tanks.get(count).state != 0){
                tanks.get(count).time++;
                if(tanks.get(count).time == 250){
                    tanks.get(count).state = 0;
                    tanks.get(count).time = 0;
                }
                if(tanks.get(count).state == 4 && tanks.get(count).shots.size() > 1){
                    tanks.get(count).delay++;
                }
                if(tanks.get(count).state == 4 && tanks.get(count).delay == 8 && tanks.get(count).shots.size() > 1){
                    tanks.get(count).delay = 0;
                    tanks.get(count).shots.clear();
                }
                if(tanks.get(count).state == 1 && tanks.get(count).shoot && count != 0){
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(count).shots.add(0,new Bullet(tanks.get(count).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(count).a))) * tanks.get(count).d,tanks.get(count).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(count).a))) * tanks.get(count).u,tanks.get(count).a-10,tanks.get(count).d,tanks.get(count).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(count).shots.add(0,new Bullet(tanks.get(count).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(count).a))) * tanks.get(count).d,tanks.get(count).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(count).a))) * tanks.get(count).u,tanks.get(count).a+10,tanks.get(count).d,tanks.get(count).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(count).shots.add(0,new Bullet(tanks.get(count).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(count).a))) * tanks.get(count).d,tanks.get(count).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(count).a))) * tanks.get(count).u,tanks.get(count).a-5,tanks.get(count).d,tanks.get(count).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(count).shots.add(0,new Bullet(tanks.get(count).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(count).a))) * tanks.get(count).d,tanks.get(count).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(count).a))) * tanks.get(count).u,tanks.get(count).a+5,tanks.get(count).d,tanks.get(count).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(count).shots.add(0,new Bullet(tanks.get(count).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(count).a))) * tanks.get(count).d,tanks.get(count).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(count).a))) * tanks.get(count).u,tanks.get(count).a,tanks.get(count).d,tanks.get(count).u,0,0,0,0));
                    }
                }
                else if(tanks.get(count).state == 1 && tanks.get(count).shoot && count == 0){
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))-10,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))+10,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))+5,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x))))-5,tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                    if(rand.nextInt(3)+1 == 1){
                        tanks.get(0).shots.add(0,new Bullet(tanks.get(0).x+(int)Math.round(35*Math.cos(Math.toRadians(tanks.get(0).a))) * tanks.get(0).d,tanks.get(0).y-(int)Math.round(35*Math.sin(Math.toRadians(tanks.get(0).a))) * tanks.get(0).u,Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(0).y-mY)/(mX-tanks.get(0).x)))),tanks.get(0).d,tanks.get(0).u,0,0,0,0));
                    }
                }
            }
            if(tanks.get(count).state == 2 || tanks.get(count).state == 3){
                if(tanks.get(count).delay != 0){
                    tanks.get(count).delay--;
                }
            }
            if(power){
                if(p.x>tanks.get(count).x-25 && p.x<tanks.get(count).x+25 && p.y>tanks.get(count).y-25 && p.y<tanks.get(count).y+25 && p.state != 0){
                    tanks.get(count).state = p.state;
                    p.state = 0;
                }
            }
            if(tanks.get(count).state == 0){
                tanks.get(count).speed = 5;
            }
            else{
                tanks.get(count).speed = 7;
            }
            if(!won && !tie && !pause){
                for(int count2 = 0;count2 != tanks.size();count2++){
                    for(int count3 = tanks.get(count).shots.size()-1;count3 != -1;count3--){
                        if(tanks.get(count).shots.get(count3).x > tanks.get(count2).x-25 && tanks.get(count).shots.get(count3).x < tanks.get(count2).x+25 && tanks.get(count).shots.get(count3).y > tanks.get(count2).y-25 && tanks.get(count).shots.get(count3).y < tanks.get(count2).y+25){
                            if(gamemode == 1 && !tanks.get(count2).dead){
                                tanks.get(count2).score++;
                            }
                            else if(gamemode == 0 && !tanks.get(count2).dead){
                                tanks.get(count).stock--;
                            }
                            tanks.get(count2).dead = true;
                            tanks.get(count).shots.remove(count3);
                        }
                    }
                }
                for(int count2 = tanks.get(count).shots.size()-1;count2 != -1;count2--){
                    if(tanks.get(count).state == 1 || tanks.get(count).state == 2 || tanks.get(count).state == 3){
                        if(tanks.get(count).shots.get(count2).bounce > 0 || tanks.get(count).shots.get(count2).timer > 10){
                            tanks.get(count).shots.remove(count2);
                        }
                    }
                    else if(tanks.get(count).state == 4){
                        if(tanks.get(count).shots.size()>1){
                            if(tanks.get(count).shots.get(count2).bounce > 0){
                                tanks.get(count).shots.remove(count2);
                            }
                        }
                    }
                    else{
                        if(tanks.get(count).shots.get(count2).bounce > 2 || tanks.get(count).shots.get(count2).timer > 0){
                            tanks.get(count).shots.remove(count2);
                        }
                        if(tanks.get(count).shots.size()>3){
                            tanks.get(count).shots.clear();
                            break;
                        }
                    }
                }
            }
            else if(tanks.get(count).dead){
                tanks.get(count).respawn++;
            }
            for(int count2 = 0;count2 != tanks.get(count).shots.size();count2++){
                if(!won && !tie && !pause){
                    tanks.get(count).shots.get(count2).pY = tanks.get(count).shots.get(count2).y;
                    tanks.get(count).shots.get(count2).pX = tanks.get(count).shots.get(count2).x;
                    if(tanks.get(count).state == 1){
                        tanks.get(count).shots.get(count2).y -= Math.round(20*Math.sin(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).u;
                        tanks.get(count).shots.get(count2).x += Math.round(20*Math.cos(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).d;
                        tanks.get(count).shots.get(count2).timer++;
                    }
                    else if(tanks.get(count).state == 2){
                        tanks.get(count).shots.get(count2).y -= Math.round(40*Math.sin(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).u;
                        tanks.get(count).shots.get(count2).x += Math.round(40*Math.cos(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).d;
                    }
                    else if(tanks.get(count).state == 4 || tanks.get(count).state == 3){
                        tanks.get(count).shots.get(count2).y -= Math.round(12*Math.sin(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).u;
                        tanks.get(count).shots.get(count2).x += Math.round(12*Math.cos(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).d;
                    }
                    else{
                        tanks.get(count).shots.get(count2).y -= Math.round(10*Math.sin(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).u;
                        tanks.get(count).shots.get(count2).x += Math.round(10*Math.cos(Math.toRadians(tanks.get(count).shots.get(count2).a))) * tanks.get(count).shots.get(count2).d;
                    }
                    for(int count3 = 0;count3 != obj.size();count3++){
                        if(tanks.get(count).shots.get(count2).y > obj.get(count3).y1 && tanks.get(count).shots.get(count2).y < obj.get(count3).y2 && tanks.get(count).shots.get(count2).x > obj.get(count3).x1 && tanks.get(count).shots.get(count2).x < obj.get(count3).x2 && !(tanks.get(count).shots.get(count2).pY > obj.get(count3).y1 && tanks.get(count).shots.get(count2).pY < obj.get(count3).y2)){
                            tanks.get(count).shots.get(count2).u *= -1;
                            tanks.get(count).shots.get(count2).bounce++;
                        }
                        else if(tanks.get(count).shots.get(count2).y > obj.get(count3).y1 && tanks.get(count).shots.get(count2).y < obj.get(count3).y2 && tanks.get(count).shots.get(count2).x > obj.get(count3).x1 && tanks.get(count).shots.get(count2).x < obj.get(count3).x2){
                            tanks.get(count).shots.get(count2).d *= -1;
                            tanks.get(count).shots.get(count2).bounce++;
                        }
                    }
                    if(tanks.get(count).shots.get(count2).x < 0 || tanks.get(count).shots.get(count2).x > 1580){
                        tanks.get(count).shots.get(count2).d *= -1;
                        tanks.get(count).shots.get(count2).bounce++;
                    }
                    else if(tanks.get(count).shots.get(count2).y < 0 || tanks.get(count).shots.get(count2).y > 800){
                        tanks.get(count).shots.get(count2).u *= -1;
                        tanks.get(count).shots.get(count2).bounce++;
                    }
                }
                if(tanks.get(count).state == 1){
                    g.setColor(new Color(100,0,0));
                }
                else if(tanks.get(count).state == 2){
                    g.setColor(new Color(120,0,255));
                }
                else if(tanks.get(count).state == 3){
                    g.setColor(Color.yellow);
                }
                else if(tanks.get(count).state == 4){
                    g.setColor(Color.pink);
                }
                else if(count == 1){
                    g.setColor(Color.blue);
                }
                else if(count == 0){
                    g.setColor(Color.red);
                }
                tanks.get(count).shots.get(count2).drawBullet(g);
            }
            if(!won && !tie && !pause){
                if(tanks.get(count).up){
                    for(int count2 = 0;count2 != tanks.size();count2++){
                        if(((tanks.get(count).x-25 >= tanks.get(count2).x-25 && tanks.get(count).x-25 <= tanks.get(count2).x+25) || (tanks.get(count).x+25 >= tanks.get(count2).x-25 && tanks.get(count).x+25 <= tanks.get(count2).x+25)) && (tanks.get(count).y-30 >= tanks.get(count2).y-25 && tanks.get(count).y-30 <= tanks.get(count2).y+25)){
                            not = true;
                        }
                    }
                    for(int count3 = 0;count3 != obj.size();count3++){
                        if(((tanks.get(count).x-25 >= obj.get(count3).x1 && tanks.get(count).x-25 <= obj.get(count3).x2 && tanks.get(count).y-(25+tanks.get(count).speed) >= obj.get(count3).y1 && tanks.get(count).y-(25+tanks.get(count).speed) <= obj.get(count3).y2) || (tanks.get(count).x+25 >= obj.get(count3).x1 && tanks.get(count).x+25 <= obj.get(count3).x2 && tanks.get(count).y-(25+tanks.get(count).speed) >= obj.get(count3).y1 && tanks.get(count).y-(25+tanks.get(count).speed) <= obj.get(count3).y2)) || tanks.get(count).y-(25+tanks.get(count).speed)<=5){
                            not = true;
                        }
                    }
                    if(!not && tanks.get(count).state == 0){
                        tanks.get(count).y -= tanks.get(count).speed;
                    }
                    else if(!not){
                        tanks.get(count).y -= tanks.get(count).speed;
                    }
                    not = false;
                }
                if(tanks.get(count).down){
                    for(int count2 = 0;count2 != tanks.size();count2++){
                        if(((tanks.get(count).x-25 >= tanks.get(count2).x-25 && tanks.get(count).x-25 <= tanks.get(count2).x+25) || (tanks.get(count).x+25 >= tanks.get(count2).x-25 && tanks.get(count).x+25 <= tanks.get(count2).x+25)) && (tanks.get(count).y+(25+tanks.get(count).speed) >= tanks.get(count2).y-25 && tanks.get(count).y+(25+tanks.get(count).speed) <= tanks.get(count2).y+25)){
                            not = true;
                        }
                    }
                    for(int count3 = 0;count3 != obj.size();count3++){
                        if(((tanks.get(count).x-25 >= obj.get(count3).x1 && tanks.get(count).x-25 <= obj.get(count3).x2 && tanks.get(count).y+((25+tanks.get(count).speed)) >= obj.get(count3).y1 && tanks.get(count).y+(25+tanks.get(count).speed) <= obj.get(count3).y2) || (tanks.get(count).x+25 >= obj.get(count3).x1 && tanks.get(count).x+25 <= obj.get(count3).x2 && tanks.get(count).y+(25+tanks.get(count).speed) >= obj.get(count3).y1 && tanks.get(count).y+(25+tanks.get(count).speed) <= obj.get(count3).y2)) || tanks.get(count).y+(25+tanks.get(count).speed)>=795){
                            not = true;
                        }
                    }
                    if(!not && tanks.get(count).state == 0){
                        tanks.get(count).y += tanks.get(count).speed;
                    }
                    else if(!not){
                        tanks.get(count).y += tanks.get(count).speed;
                    }
                    not = false;
                }
                if(tanks.get(count).left){
                    for(int count2 = 0;count2 != tanks.size();count2++){
                        if(((tanks.get(count).y-25 >= tanks.get(count2).y-25 && tanks.get(count).y-25 <= tanks.get(count2).y+25) || (tanks.get(count).y+25 >= tanks.get(count2).y-25 && tanks.get(count).y+25 <= tanks.get(count2).y+25)) && (tanks.get(count).x-(25+tanks.get(count).speed) >= tanks.get(count2).x-25 && tanks.get(count).x-(25+tanks.get(count).speed) <= tanks.get(count2).x+25)){
                            not = true;
                        }
                    }
                    for(int count3 = 0;count3 != obj.size();count3++){
                        if(((tanks.get(count).x-(25+tanks.get(count).speed) >= obj.get(count3).x1 && tanks.get(count).x-(25+tanks.get(count).speed) <= obj.get(count3).x2 && tanks.get(count).y-25 >= obj.get(count3).y1 && tanks.get(count).y-25 <= obj.get(count3).y2) || (tanks.get(count).x-(25+tanks.get(count).speed) >= obj.get(count3).x1 && tanks.get(count).x-(25+tanks.get(count).speed) <= obj.get(count3).x2 && tanks.get(count).y+25 >= obj.get(count3).y1 && tanks.get(count).y+25 <= obj.get(count3).y2)) || tanks.get(count).x-(25+tanks.get(count).speed)<=5){
                            not = true;
                        }
                    }
                    if(!not && tanks.get(count).state == 0){
                        tanks.get(count).x -= tanks.get(count).speed;
                    }
                    else if(!not){
                        tanks.get(count).x -= tanks.get(count).speed;
                    }
                    not = false;
                }
                if(tanks.get(count).right){
                    for(int count2 = 0;count2 != tanks.size();count2++){
                        if(((tanks.get(count).y-25 >= tanks.get(count2).y-25 && tanks.get(count).y-25 <= tanks.get(count2).y+25) || (tanks.get(count).y+25 >= tanks.get(count2).y-25 && tanks.get(count).y+25 <= tanks.get(count2).y+25)) && (tanks.get(count).x+30 >= tanks.get(count2).x-25 && tanks.get(count).x+30 <= tanks.get(count2).x+25)){
                            not = true;
                        }
                    }
                    for(int count3 = 0;count3 != obj.size();count3++){
                        if(((tanks.get(count).x+(25+tanks.get(count).speed) >= obj.get(count3).x1 && tanks.get(count).x+(25+tanks.get(count).speed) <= obj.get(count3).x2 && tanks.get(count).y-25 >= obj.get(count3).y1 && tanks.get(count).y-25 <= obj.get(count3).y2) || (tanks.get(count).x+(25+tanks.get(count).speed) >= obj.get(count3).x1 && tanks.get(count).x+(25+tanks.get(count).speed) <= obj.get(count3).x2 && tanks.get(count).y+25 >= obj.get(count3).y1 && tanks.get(count).y+25 <= obj.get(count3).y2)) || tanks.get(count).x+(25+tanks.get(count).speed)>=1575){
                            not = true;
                        }
                    }
                    if(!not && tanks.get(count).state == 0){
                        tanks.get(count).x += tanks.get(count).speed;
                    }
                    else if(!not){
                        tanks.get(count).x += tanks.get(count).speed;
                    }
                    not = false;
                }
                if(!tanks.get(0).dead && count == 0){
                    if(mX < tanks.get(count).x && tanks.get(count).d == 1){
                        tanks.get(count).d *= -1;
                    }
                    else if(mX > tanks.get(count).x && tanks.get(count).d == -1){
                        tanks.get(count).d *= -1;
                    }
                    if(mY > tanks.get(count).y && tanks.get(count).u == 1){
                        tanks.get(count).u *= -1;
                    }
                    else if(mY < tanks.get(count).y && tanks.get(count).u == -1){
                        tanks.get(count).u *= -1;
                    }
                    tanks.get(count).a = Math.toDegrees(Math.atan(Math.abs(((double)tanks.get(count).y-mY)/(mX-tanks.get(count).x))));
                }
            }
            if(tanks.get(count).state == 1){
                g.setColor(new Color(100,0,0));
            }
            else if(tanks.get(count).state == 2){
                g.setColor(new Color(120,0,255));
            }
            else if(tanks.get(count).state == 3){
                g.setColor(Color.yellow);
            }
            else if(tanks.get(count).state == 4){
                g.setColor(Color.pink);
            }
            else if(count == 1){
                g.setColor(Color.blue);
                g2.setColor(Color.blue);
            }
            else if(count == 0){
                g.setColor(Color.red);
                g2.setColor(Color.red);
            }
            tanks.get(count).drawTank(g);
        }
        if(time == 0){
            if(tanks.get(0).score == tanks.get(1).score){
                tie = true;
            }
            else{
                won = true;
            }
        }
        if(power){
            p.drawPowerup(g);
        }
        if(gamemode == 0){
            if(!won && !tie){
                g.setFont(new Font("Arial",Font.BOLD,25));
                g.setColor(Color.blue);
                g.drawString("Tank One - "+tanks.get(0).stock,10,30);
                g.setColor(Color.red);
                g.drawString("Tank Two - "+tanks.get(1).stock,1400,30);
            }
            if(won && !tie){
                g.setFont(new Font("Arial",Font.BOLD,50));
                if(tanks.get(0).stock == -1){
                    g.setColor(Color.blue);
                    g.drawString("Tank one won!",650,400);
                }
                else if(tanks.get(1).stock == -1){
                    g.setColor(Color.red);
                    g.drawString("Tank two won!",650,400);
                }
            }
            else if(tie){
                g.setColor(Color.green);
                g.setFont(new Font("Arial",Font.BOLD,50));
                g.drawString("It's a tie!",650,400);
            }
        }
        else if(gamemode == 1){
            g.setFont(new Font("Arial",Font.BOLD,25));
            g.setColor(Color.blue);
            g.drawString("Tank One - "+tanks.get(0).score,10,30);
            g.setColor(Color.red);
            g.drawString("Tank Two - "+tanks.get(1).score,1400,30);
            if(won && !tie){
                g.setFont(new Font("Arial",Font.BOLD,50));
                if(tanks.get(0).score > tanks.get(1).score){
                    g.setColor(Color.blue);
                    g.drawString("Tank one won!",650,400);
                }
                else if(tanks.get(1).score > tanks.get(0).score){
                    g.setColor(Color.red);
                    g.drawString("Tank two won!",650,400);
                }
            }
            else if(tie){
                g.setColor(Color.green);
                g.setFont(new Font("Arial",Font.BOLD,50));
                g.drawString("It's a tie!",650,400);
            }
        }
        try{
            Thread.sleep(35);
        }catch(Exception e){}
        repaint();
    }
}